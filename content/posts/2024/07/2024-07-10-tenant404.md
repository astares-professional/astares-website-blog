---
title: "HTTP 404"
date: 2024-07-10T09:00:00-07:00
lastmod: 2024-07-10T09:00:00-07:00
draft: false
categories: ["Security"]
tags: ["HTTP", "Security", "Cloud", "Infrastructure"]
description: "How to Handle 404"
slug: "web-handle-404"
---

# HTTP 404

*Few things are as frustrating as clicking on a link only to be greeted with an HTTP 404 error. While it may seem like a minor inconvenience, unhandled 404 errors can negatively impact user experience but also security.*

## What is an HTTP 404 Error? 

An [HTTP 404](https://de.wikipedia.org/wiki/HTTP_404) error occurs when a user attempts to access a page that does not exist. Whether it’s due to broken links, mistyped URLs, or deleted pages, the result is the same—a “not found” message that can frustrate visitors.

Technically the HTTP 404 status code is defined in the [RFC 9110](https://www.rfc-editor.org/rfc/rfc9110.html) specification, which replaces the older [RFC 2616](https://www.rfc-editor.org/rfc/rfc2616.html) from HTTP/1.1 protocol description.

##  Why should you care

Understanding HTTP status codes like 404 Not Found is crucial from both a **user experience** and **security** standpoint.

While a **customer** visiting your webpage or web application might be focused on easy navigation and a good user experience handling the HTTP codes from your side helps users understand what went wrong and how to proceed. So a **well-designed error page** can guide users to relevant content instead of leading them to a dead end.

Its interesting also from another point of view: the "out of the box" security level that comes with these error messages. Because an **important security aspect** for your web infrastructure is that **Default error pages** often **reveal information about the web server** (e.g., Nginx, Apache, IIS), its version, or even underlying technologies, which **can be exploited by attackers**.

Hackers can use 404 responses to probe a site for sensitive endpoints, testing which URLs exist or do not exist. Also if you tell an attacker what webserver technology you use but also the exact version you give too much hints to such a third party. With such additional info a professional hacker can easily check the internet for **known vulnerabilities** and be much more specific in his attacks to your infrastructure.

## How do standard webservers respond

While web services or web applications are implemented in many different technologies like [Java](https://www.java.com/en/), JavaScript/[NodeJS](https://nodejs.org/), [PHP](https://www.php.net/), [Ruby (on Rails)](https://rubyonrails.org/), ... on application servers typically the operate behind a **load balancer or web server at the front**.

Using [Nginx](https://nginx.org/) or [Apache](https://httpd.apache.org/) but also [IIS](https://www.iis.net/) or [HAProxy](https://www.haproxy.org/) as a **frontend server** is a common strategy for managing web traffic efficiently. These web servers serve as reverse proxies, load balancers, or even security gateways, optimizing the way requests reach backend services.

### NGINX

![NGINX Default 404](../images/nginx-404.png)

By default, [Nginx](https://nginx.org/) responds to a 404 Not Found error with a simple, minimalistic page that includes the following information:

- Status Code: 404 Not Found
- Plain Text Message: "404 Not Found"
- Server Signature: "nginx" (indicating that the response is generated by Nginx)

This default response is hardcoded into Nginx and does not include any styling or additional details. You can customize the 404 page using the *"error_page"* directive in your Nginx configuration

### APACHE

By default, [Apache](https://httpd.apache.org/) responds to a 404 Not Found error with a simple, unstyled page that includes:

- Status Code: 404 Not Found
- Plain Text Message: "Not Found"
- Requested URL: Displays the URL that was not found.
- Server Signature: Includes the Apache version and server details (if enabled).

![Apache Default 404](../images/apache-404.png)

This default response can reveal server information, which may be a **security risk**. For 

- Disable the server signature (*ServerSignature Off* in Apache config).
- Customize the error page using the *ErrorDocument* directive.

### Webservers in the application layer

If you do not handle the response at the front door the user might receive the 404 from the application layer. For instance when your service is implemented using Java in [Spring](https://spring.io/) or [Jakarta EE](https://jakarta.ee/) and running on Tomcat or Glassfish the response might look like:

![Glassfish Default 404](../images/glassfish-404.png)

Also here we get the 

- Status Code: 404 Not Found
- Message: "Not Found"
- Description: "The requested resource is not available."
- Server Signature: "GlassFish Server Open Source Edition" (if enabled)

and reveal infos about our infrastructure element, its version as well as the implementation technology. These are all useful informations for an attacker to check for vulnerabilities.

Therefore you cloud/should customize the error page using the <error-page> directive in web.xml in a production deployment or [handle it on the global level](https://javadude.wordpress.com/2010/12/07/customized-error-pages-for-glassfish-v3/).

## HTTP 404 @Tech companies

*It's interesting to check and see how the big tech giants handle broken links and bad requests:*

### Google

Google handles standard 404 with a customized response. Just visit [https://google.com/foo](https://google.com/foo) to try yourself.

![Google 404](../images/google-404.png)

### Microsoft 

Microsoft also handles the 404 gracefully when you visit pages such as [https://www.microsoft.com/foo](https://www.microsoft.com/foo).
But when you check in environment such as Azure and M365 with specific portal solutions you see that they seem to be configured differently in that regard. 

Lets try on the M365 admin portal where "foo" is definitely not a relative URL leading to a config blade that would make sense:

  https://admin.microsoft.com/Adminportal/foo

![Microsoft M365 404](../images/microsoft-404-handled.png)

Fine - the request is handled with a custom page as response.

Now lets try a more deep URL like 

[https://admin.microsoft.com/Adminportal/Home/billoverview/billing-profiles](https://admin.microsoft.com/Adminportal/Home/billoverview/billing-profiles)

we get the following screen:

![Microsoft IIS 404](../images/microsoft-404-iis.png)

If you have worked with different webservers like me in the past you will easily notice that this page is a response from an Internet Information Server (IIS). 

Now it is not a surprise that Microsoft eats its own dog food and use their own enterprise webserver - but it is interesting that they do not handle the case with a custom page.

## What can you do

### For custom infrastructure

With technological advancements like AI, geopolitical tensions, and emerging threats security web security is not only important - it is a complex and evolving landscape.

Define a **Mitigation Strategy** for your 
- frontend server but also for your
- web services
- web applications
- API endpoints

and anything that is exposed to the public and accessible via a URL. 

For instance you can easily
- **Customize error pages** to avoid leaking server details
- **Disable version disclosure** in web server configurations
- **Monitor logs** for specific codes like 404 to detect unusual request patterns that may indicate scanning or enumeration attempts.

### For infrastructure that you do not own

Even with modern cloud based solutions where you have to take care less on your infrastructure you should test and check how your web based system behaves to known and unknown requests.

For instance when you deploy a Azure Service App, an Function as a service (FaaS) in Azure or when you deploy an application behind technologies such as [Azure Application Gateway](https://learn.microsoft.com/en-us/azure/application-gateway/overview) or [Oracle Load balancer](https://docs.oracle.com/en-us/iaas/Content/Balance/Concepts/balanceoverview.htm) in [OCI](http://cloud.oracle.com/) check and research what the cloud service provider offers. Even if you do not own the service itself you are [able to define a custom response](https://learn.microsoft.com/en-us/azure/application-gateway/custom-error).

## Conclusion

*Managing broken links effectively and designing an engaging 404 page can turn a potential frustration into a seamless user experience. Custom error pages and proper handling of HTTP codes also help to hide infrastructure details, reducing exposure to potential security attacks.*

*Have you ever seen a clever 404 page that made you smile?*